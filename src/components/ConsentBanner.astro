---
// No props needed â€” self-contained consent overlay
---

<!-- Full-screen overlay backdrop -->
<div
  id="consent-overlay"
  class="fixed inset-0 z-[9999] flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-500"
  role="dialog"
  aria-label="Cookie consent"
  aria-modal="true"
>
  <!-- Dim background -->
  <div class="absolute inset-0 bg-black/50"></div>

  <!-- Consent card -->
  <div class="relative bg-white rounded-3xl shadow-2xl px-8 py-10 sm:px-10 sm:py-12 max-w-md w-[calc(100%-2rem)] mx-4 text-center">
    <p class="text-3xl mb-4">ğŸª</p>
    <p class="text-base sm:text-lg text-[var(--color-brand-primary-text)] font-sans leading-relaxed mb-8">
      We gebruiken cookies om je ervaring te verbeteren en onze website te optimaliseren.
    </p>
    <div class="flex flex-col items-center gap-4">
      <button
        id="consent-accept"
        class="w-full max-w-[260px] px-8 py-3 rounded-full text-base font-heading font-semibold bg-[var(--color-brand-accent)] hover:bg-[var(--color-brand-accent-hover)] text-white transition-colors duration-200"
      >
        Accepteren
      </button>
      <div class="flex items-center gap-6">
        <button
          id="consent-reject"
          class="text-sm text-[var(--color-brand-muted)] hover:text-[var(--color-brand-primary-text)] transition-colors duration-200"
        >
          Weigeren
        </button>
        <a
          href="/algemene-voorwaarden/"
          class="text-sm text-[var(--color-brand-muted)] hover:text-[var(--color-brand-primary-text)] underline underline-offset-2 transition-colors duration-200"
        >
          Meer info
        </a>
      </div>
    </div>
  </div>
</div>

<script is:inline>
(function() {
  // Ensure gtag is available (defined in Layout.astro consent defaults script)
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}

  // Don't show overlay if consent already stored and valid
  // NOTE: Same validation logic exists in Layout.astro consent defaults script â€” keep both in sync
  try {
    var stored = localStorage.getItem('cookie_consent');
    if (stored) {
      var data = JSON.parse(stored);
      var sixMonths = 180 * 24 * 60 * 60 * 1000;
      if (data.timestamp && (Date.now() - data.timestamp) < sixMonths) {
        return; // Valid choice exists, don't show overlay
      }
    }
  } catch(e) {}

  var overlay = document.getElementById('consent-overlay');
  if (!overlay) return;

  // Show overlay immediately â€” no delay, user must choose
  overlay.classList.remove('opacity-0', 'pointer-events-none');
  overlay.classList.add('opacity-100');

  // Block scrolling while overlay is visible
  document.body.style.overflow = 'hidden';

  function hideOverlay() {
    overlay.classList.remove('opacity-100');
    overlay.classList.add('opacity-0', 'pointer-events-none');
    document.body.style.overflow = '';
  }

  function storeChoice(choice) {
    try {
      localStorage.setItem('cookie_consent', JSON.stringify({
        choice: choice,
        timestamp: Date.now()
      }));
    } catch(e) {}
  }

  document.getElementById('consent-accept').addEventListener('click', function() {
    gtag('consent', 'update', {
      'ad_storage': 'granted',
      'ad_user_data': 'granted',
      'ad_personalization': 'granted',
      'analytics_storage': 'granted'
    });
    storeChoice('granted');
    hideOverlay();
  });

  document.getElementById('consent-reject').addEventListener('click', function() {
    storeChoice('denied');
    hideOverlay();
  });
})();
</script>
